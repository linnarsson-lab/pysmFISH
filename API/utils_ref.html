

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>utils &mdash; pysmFISH 0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="pysmFISH 0 documentation" href="../index.html"/>
        <link rel="up" title="API" href="index.html"/>
        <link rel="next" title="Stitching API" href="stitching/index.html"/>
        <link rel="prev" title="object_based_segmentation" href="object_based_segmentation_ref.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> pysmFISH
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Welcome to pysmFISH!</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cluster/index.html">Cluster setup</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="filtering_ref.html">filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="counting_ref.html">counting</a></li>
<li class="toctree-l2"><a class="reference internal" href="dots_calling_ref.html">dots_calling</a></li>
<li class="toctree-l2"><a class="reference internal" href="dots_coords_calculations_ref.html">dots_coords_calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="hdf5_utils_ref.html">hdf5_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="io_ref.html">io</a></li>
<li class="toctree-l2"><a class="reference internal" href="object_based_segmentation_ref.html">object_based_segmentation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="stitching/index.html">Stitching API</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scripts/index.html">Scripts</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/index.html">Notebooks</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../license/index.html">License</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../citing/index.html">Author and citations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ind_tables/index.html">Indices and Tables</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pysmFISH</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">API</a> &raquo;</li>
        
      <li>utils</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/API/utils_ref.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-pysmFISH.utils">
<span id="utils"></span><h1>utils<a class="headerlink" href="#module-pysmFISH.utils" title="Permalink to this headline">¶</a></h1>
<p>Collection of utility functions.</p>
<dl class="function">
<dt id="pysmFISH.utils.add_coords_to_yaml">
<code class="descclassname">pysmFISH.utils.</code><code class="descname">add_coords_to_yaml</code><span class="sig-paren">(</span><em>folder</em>, <em>hyb_nr</em>, <em>hyb_key='Hyb'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysmFISH/utils.html#add_coords_to_yaml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysmFISH.utils.add_coords_to_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Read tile number and coordinates and add them to the yaml file.
Read the tile number and microscope coordinates for each tile from
the microscope file called “coord_file_name” in “folder”.
Then insert them in dictionary “TilesPositions” in the yaml
metadata file called Experimental_metadata.yaml.</p>
<dl class="docutils">
<dt>folder: str</dt>
<dd>Exact path to the folder, including trailing “/”</dd>
<dt>hyb_nr: int</dt>
<dd>Hybridization number denoting for which hybridization we should read 
and insert the coordinates</dd>
<dt>hyb_key: str </dt>
<dd>Possible values ‘Hyb’ or ‘Strip’. To add coordinates for stripping 
if necessary.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pysmFISH.utils.check_trailing_slash">
<code class="descclassname">pysmFISH.utils.</code><code class="descname">check_trailing_slash</code><span class="sig-paren">(</span><em>dir_path</em>, <em>os_windows</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysmFISH/utils.html#check_trailing_slash"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysmFISH.utils.check_trailing_slash" title="Permalink to this definition">¶</a></dt>
<dd><p>This function check if there is a trailing slash at the end of a 
directory path and add it if missing</p>
<dl class="docutils">
<dt>dir_path= str </dt>
<dd>Path to the directory</dd>
</dl>
<dl class="docutils">
<dt>dir_path= str </dt>
<dd>Path to the directory</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pysmFISH.utils.combine_gene_pos">
<code class="descclassname">pysmFISH.utils.</code><code class="descname">combine_gene_pos</code><span class="sig-paren">(</span><em>hybridizations_infos</em>, <em>converted_positions</em>, <em>hybridization</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysmFISH/utils.html#combine_gene_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysmFISH.utils.combine_gene_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Gather info about the imaging at each hybridization.</p>
<p>This function creates a dictionary where for each hybridization
are shown the genes and number of positions imaged for each
gene. This function will be useful to created distribution lists
for running parallel processing of the datasets.</p>
<dl class="docutils">
<dt>hybridizations_infos: dict</dt>
<dd>Dictionary with parsed Hybridizations metadata</dd>
<dt>converted_positions: dict </dt>
<dd>Dictionary with the coords of the images for all hybridization. 
The coords are a list of floats</dd>
<dt>hybridization: str</dt>
<dd>Selected hybridization to process</dd>
</dl>
<dl class="docutils">
<dt>genes_and_positions: dict </dt>
<dd>Dictionary where for each hybridization, the genes and number of 
positions imaged for each gene are showed.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pysmFISH.utils.create_single_directory">
<code class="descclassname">pysmFISH.utils.</code><code class="descname">create_single_directory</code><span class="sig-paren">(</span><em>hyb_dir</em>, <em>gene</em>, <em>hybridization</em>, <em>processing_hyb</em>, <em>suffix</em>, <em>add_slash</em>, <em>analysis_name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysmFISH/utils.html#create_single_directory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysmFISH.utils.create_single_directory" title="Permalink to this definition">¶</a></dt>
<dd><p>Function used to create a subdirectory</p>
<dl class="docutils">
<dt>hyb_dir: str  </dt>
<dd>Path to the directory of the hybridization currently processed.</dd>
<dt>gene: str </dt>
<dd>Gene name to be included in the directory.</dd>
<dt>processing_hyb: str </dt>
<dd>Name of the hybridization processed (ex. ‘EXP-17-BP3597_hyb2’).</dd>
<dt>suffix: str </dt>
<dd>Extra info to add to the directory name (ex. blended).</dd>
<dt>add_slash: str </dt>
<dd>Slash added according to the os.</dd>
<dt>analysis_name: str </dt>
<dd>Name of the analysis associated to the folder</dd>
</dl>
<dl class="docutils">
<dt>sufx_dir_path: str </dt>
<dd>Path to the created directory</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pysmFISH.utils.create_subdirectory_tree">
<code class="descclassname">pysmFISH.utils.</code><code class="descname">create_subdirectory_tree</code><span class="sig-paren">(</span><em>hyb_dir</em>, <em>hybridization</em>, <em>hybridizations_infos</em>, <em>processing_hyb</em>, <em>suffix</em>, <em>add_slash</em>, <em>skip_tags=None</em>, <em>skip_genes=None</em>, <em>analysis_name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysmFISH/utils.html#create_subdirectory_tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysmFISH.utils.create_subdirectory_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that creates the directory tree where to save the
temporary data.</p>
<dl class="docutils">
<dt>hyb_dir: str</dt>
<dd>Path of the hyb to process</dd>
<dt>hybridization: str </dt>
<dd>Name of the hybridization to process (ex. Hybridization2)</dd>
<dt>hybridizations_infos: dict </dt>
<dd>Dictionary containing the hybridizations info parsed from the 
Experimental_metadata.yaml file</dd>
<dt>processing_hyb: str </dt>
<dd>Name of the processing experiment (ex. EXP-17-BP3597_hyb2)</dd>
<dt>suffix: str </dt>
<dd>Suffix to add to the folder with useful description (ex. tmp)</dd>
<dt>add_slash: str </dt>
<dd>‘’ for win and ‘/’ for linux</dd>
<dt>skip_tags: list </dt>
<dd>tags that won’t be processed (ex. _IF)</dd>
<dt>skip_genes list</dt>
<dd>list of genes to skip</dd>
<dt>analysis_name: str </dt>
<dd>Name of the analysis run</dd>
</dl>
<dl class="docutils">
<dt>sufx_dir_path: str</dt>
<dd>Path of the sufx directory of the processed hybridization</dd>
<dt>sufx_gene_dirs: list </dt>
<dd>List of the paths of the sufx directory for the genes to process</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pysmFISH.utils.determine_os">
<code class="descclassname">pysmFISH.utils.</code><code class="descname">determine_os</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysmFISH/utils.html#determine_os"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysmFISH.utils.determine_os" title="Permalink to this definition">¶</a></dt>
<dd><p>This function check if the system is running windows.
and return the correct slash type to use</p>
<dl class="docutils">
<dt>os_windows: bool </dt>
<dd>True if the os is windows.</dd>
<dt>add_slash: str </dt>
<dd>‘’ for windows or ‘/’ for any other system</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pysmFISH.utils.experimental_metadata_parser">
<code class="descclassname">pysmFISH.utils.</code><code class="descname">experimental_metadata_parser</code><span class="sig-paren">(</span><em>hyb_dir</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysmFISH/utils.html#experimental_metadata_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysmFISH.utils.experimental_metadata_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the yaml file containing all the metadata of the experiment</p>
<p>The file must be located inside the experimental folder.</p>
<dl class="docutils">
<dt>hyb_dir: str</dt>
<dd>Path to the .yaml file containing the metadata of the experiment</dd>
</dl>
<dl class="docutils">
<dt>experiment_infos: dict </dt>
<dd>Dictionary with the information on the experiment.</dd>
<dt>HybridizationInfos: dict </dt>
<dd>Dictionary with the information on the hybridization.</dd>
<dt>converted_positions: dict </dt>
<dd>Dictionary with the coords of the images for all hybridization. 
The coords are a list of floats</dd>
<dt>microscope_parameters: dict </dt>
<dd>Dictionary with the microscope parameters for all hybridization</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pysmFISH.utils.filtering_raw_counting_config_parser">
<code class="descclassname">pysmFISH.utils.</code><code class="descname">filtering_raw_counting_config_parser</code><span class="sig-paren">(</span><em>hyb_dir</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysmFISH/utils.html#filtering_raw_counting_config_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysmFISH.utils.filtering_raw_counting_config_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the yaml file containing all configurations for running the analysis</p>
<p>The file must be located inside the experimental folder.</p>
<dl class="docutils">
<dt>hyb_dir: str </dt>
<dd>Path to the .yaml file containing the metadata of the experiment</dd>
</dl>
<dl class="docutils">
<dt>config_parameters: dict </dt>
<dd>Dictionary with all the configuration parameters</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pysmFISH.utils.general_yaml_parser">
<code class="descclassname">pysmFISH.utils.</code><code class="descname">general_yaml_parser</code><span class="sig-paren">(</span><em>file_path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysmFISH/utils.html#general_yaml_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysmFISH.utils.general_yaml_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a general yaml file and return the dictionary with all the 
content</p>
<p>The file must be located inside the experimental folder.</p>
<dl class="docutils">
<dt>file_path: str </dt>
<dd>Path to the .yaml file containing the metadata of the experiment</dd>
</dl>
<dl class="docutils">
<dt>parameters: dict </dt>
<dd>Dictionary with all the configuration parameters</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pysmFISH.utils.identify_nodes">
<code class="descclassname">pysmFISH.utils.</code><code class="descname">identify_nodes</code><span class="sig-paren">(</span><em>client</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysmFISH/utils.html#identify_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysmFISH.utils.identify_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Function used to determine the address of the nodes in order to 
better split the work</p>
<dl class="docutils">
<dt>client: dask.obj </dt>
<dd>Dask.distributed client.</dd>
</dl>
<dl class="docutils">
<dt>node_addresses: OrderedDict</dt>
<dd>Ordered dictionary. The keys are the addresses of the nodes and the 
items are the full addresses of teh workers of a specific node.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pysmFISH.utils.init_console_logger">
<code class="descclassname">pysmFISH.utils.</code><code class="descname">init_console_logger</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysmFISH/utils.html#init_console_logger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysmFISH.utils.init_console_logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Send the logging output to the stderr stream.
After running this function the logging message will typically end up
in your console output.</p>
</dd></dl>

<dl class="function">
<dt id="pysmFISH.utils.init_file_logger">
<code class="descclassname">pysmFISH.utils.</code><code class="descname">init_file_logger</code><span class="sig-paren">(</span><em>log_path</em>, <em>maxBytes=0</em>, <em>backupCount=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysmFISH/utils.html#init_file_logger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysmFISH.utils.init_file_logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Send the logging output to a file.</p>
<p>The logs are placed in a directory called “logs”, if this directory
is not found at the location denoted by log_path, it will be made.
On each run of the program a new log file will be produced.
max_bytes and backup_count are passed to RotatingFileHandler
directly. So a new file will be produced when the filesize
reaches max_bytes. If either of max_bytes or backup_count is zero,
rollover never occurs and everything will be logged in one file.</p>
<dl class="docutils">
<dt>log_path: str </dt>
<dd>Full path to the directory where the log directory is/should go.</dd>
<dt>maxBytes: int </dt>
<dd>Maximum size in bytes of a single log file, a new log file will be 
started when this size is reached. If zero, all logging will be 
written to one file. (Default: 0)</dd>
<dt>backup_count: int </dt>
<dd>The maxinum number of logging file that will be produced. If zero, 
all logging will be written to one file. (Default: 0)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pysmFISH.utils.list_chunking">
<code class="descclassname">pysmFISH.utils.</code><code class="descname">list_chunking</code><span class="sig-paren">(</span><em>list_to_chunk</em>, <em>num_chunks</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysmFISH/utils.html#list_chunking"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysmFISH.utils.list_chunking" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function used to chunk a list in a number of sublists equal to
num_chunks</p>
<dl class="docutils">
<dt>list_to_chunk: list </dt>
<dd>List to be chunked</dd>
<dt>num_chunks: int </dt>
<dd>Number of sublists to obtain</dd>
</dl>
<dl class="docutils">
<dt>chunked_list: list </dt>
<dd>List containing the chunked lists</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pysmFISH.utils.partial_image_mean">
<code class="descclassname">pysmFISH.utils.</code><code class="descname">partial_image_mean</code><span class="sig-paren">(</span><em>img_paths</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pysmFISH/utils.html#partial_image_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysmFISH.utils.partial_image_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function used to calculate the mean of a set of images. It runs on a
worker and help parallel image processing</p>
<dl class="docutils">
<dt>img_paths: list </dt>
<dd>List of paths to the images saved as <a href="#id1"><span class="problematic" id="id2">*</span></a>.npy</dd>
</dl>
<dl class="docutils">
<dt>ImgMean: np.array </dt>
<dd>Array storing the calculated image mean</dd>
</dl>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="stitching/index.html" class="btn btn-neutral float-right" title="Stitching API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="object_based_segmentation_ref.html" class="btn btn-neutral" title="object_based_segmentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, simone codeluppi.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>